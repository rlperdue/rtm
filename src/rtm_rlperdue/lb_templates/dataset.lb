CHANGEDIR "[mesh_dir]"
READ "[mesh_name]"
CHANGEDIR "[regions_dir]"
REGLOAD "[regions_name]", "*", 0

DEFINT nregions, count
LET nregions = [n_regions]
LET count = [count]

DEFDBL pressure
LET pressure = 100000

DIM k(nregions)
[k_block]

[scaleperm_block]

PROC Fill
    SETGATE "Gate", 1, pressure
    DO WHILE (SONUMBEREMPTY()>0)
        SOLVE
    LOOP
    CHANGEDIR "[resfolder]"
    SETOUTTYPE "msh"
    WRITE "res" + STR(count) + ".msh"
ENDPROC

CALL Fill
EXIT
